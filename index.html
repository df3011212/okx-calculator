<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <footer style="text-align:center; padding: 16px; font-size: 14px; color: gray;">
    æ´ªå£«å¼˜ ç‰ˆæ¬Šæ‰€æœ‰ Â©2025 å¤§ä»è€å¸«æŠ•è³‡ç†è²¡å­¸å ‚å°ˆå±¬å·¥å…·
  </footer>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>OKX æ§“æ¡¿ç²åˆ©è¨ˆç®—å·¥å…·</title>
  <!-- âœ… ä¿®æ­£éçš„ CSS è·¯å¾‘ -->
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <!-- âœ… åŠ å¯†è²¨å¹£æœå°‹å½ˆçª— -->
  <div id="cryptoSearchModalOverlay">
    <div id="cryptoSearchModal">
      <h2>ğŸ” åŠ å¯†è²¨å¹£æœå°‹</h2>
      <input type="text" id="cryptoSearchInput" placeholder="æœå°‹å¹£ç¨®ï¼ˆå¦‚ BTCã€ETHã€OPï¼‰">

  <!-- ğŸ” æœå°‹çµæœ -->
  <div class="section-header">
    <h3>ğŸ” æœå°‹çµæœ</h3>
    <button class="btn-clear" onclick="clearSearchResult()">ğŸ—‘ ä¸€éµæ¸…é™¤</button>
  </div>
  <div id="searchResult" class="crypto-list"></div>

  <!-- ğŸ•˜ æœ€è¿‘æœå°‹ -->
  <div class="section-header">
    <h3>ğŸ•˜ æœ€è¿‘æœå°‹</h3>
    <button class="btn-clear" onclick="clearCryptoHistory()">ğŸ—‘ ä¸€éµæ¸…é™¤</button>
  </div>
  <div class="crypto-list" id="recentSearchList"></div>

  
      <div class="crypto-favorite">
        <h3>â­ æˆ‘çš„æœ€æ„›</h3>
        <div id="favoriteList"></div>
      </div>

      <div class="actions">
        <button onclick="closeCryptoSearch()">é—œé–‰</button>
      </div>
    </div>
  </div>

  <div class="container">
    <div class="section yellow">
      <h2>é–‹å–®é€Ÿç®—è¡¨</h2>

      <label>é¸æ“‡å¹£ç¨®
        <div class="symbol-row">
          <input id="symbolInput" type="text" autocomplete="off" list="symbolList" />
          <button type="button" class="clear-btn" onclick="document.getElementById('symbolInput').value='';">æ¸…é™¤</button>
        </div>
      </label>
      

      <label>æœ¬é‡‘ USDT
        <input id="capital" type="number" value="1658"/>
      </label>

      <label>é¦–æ¬¡é–‹å€‰åƒ¹æ ¼ï¼ˆæ‰‹å‹•/å¸‚åƒ¹åˆ‡æ›ï¼‰</label>
      <div class="price-row">
        <input id="entryPrice" type="number" step="0.00001"/>
        <button id="togglePriceBtn">ä½¿ç”¨é™åƒ¹</button>
      </div>
              <!-- æ–°å¢ï¼šè³‡é‡‘è²»ç‡é¡¯ç¤ºå€ -->
        <div id="funding-rate-container" style="margin-top: 8px; font-weight: bold;">
        è³‡é‡‘è²»ç‡ï¼š<span id="funding-rate" style="color:gray;">è®€å–ä¸­...</span>
        <div id="funding-rate-long" style="margin-top: 4px; font-size: 14px;"></div>
        <div id="funding-rate-short" style="margin-top: 2px; font-size: 14px;"></div>
      </div>

      <label>ä¿è­‰é‡‘æ¯”ä¾‹ (%)
        <input id="marginRatio" type="number" value="5"/>
      </label>

      <label>æ­¢ææ¯”ä¾‹ (%)
        <input id="stoploss" type="number" value="7.52"/>
      </label>

      <label>æœ€å¤§è™§æ USDT
        <input id="maxLoss" type="number" value="300"/>
      </label>

      <div class="results-grid">
        <div class="result-item">æ§“æ¡¿å€æ•¸ï¼š<span id="leverage"></span> å€</div>
        <div class="result-item">ç¸½æŒå€‰é‡ï¼š<span id="position"></span></div>
        <div class="result-item">åšå¤š æˆæœ¬ï¼šç´„ <span id="longMargin"></span> USDT</div>
        <div class="result-item">åšç©º æˆæœ¬ï¼šç´„ <span id="shortMargin"></span> USDT</div>
        <div class="result-item">å‰©é¤˜å¯ç”¨è³‡é‡‘ï¼š<span id="available"></span> USDT</div>
        <div class="result-item">ç¶­æŒä¿è­‰é‡‘ç‡ï¼š<span id="maintMarginRatio"></span>%</div>
        <div class="result-item">é ä¼°å¼·å¹³åƒ¹æ ¼ï¼š<span id="liqPrice"></span> USDT</div>
      </div>

      <button id="saveBtn">ğŸ’¾ å„²å­˜ç´€éŒ„</button>
    </div>
  </div>

 <!-- ä¸­å¤®é–‹å•Ÿæ–°ç•«é¢-->
  <div id="examOverlay" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.4); z-index:9999;">
  <div style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); width:90%; max-width:960px; height:90%; background:#fff; border-radius:16px; overflow:hidden; box-shadow:0 4px 12px rgba(0,0,0,0.25);">
    <iframe src="Determinetheexitpoint.html" style="width:100%; height:100%; border:none;"></iframe>
    <button onclick="closeExam()" style="position:absolute; top:10px; right:10px; background:#dc3545; color:white; border:none; border-radius:8px; padding:0.5rem 1rem; cursor:pointer;">âœ– é—œé–‰</button>
  </div>
</div>

   <!-- é¡¯ç¤ºåŠŸèƒ½é¡¯ç¤ºå€åŸŸ-->
   <div class="container">
    <div id="manualAvgSection" style="display:none; margin: 20px 0;"></div>
   </div>
  <div id="rankingSection" class="ranking-section"></div>

  <button id="newFeatureBtn">ğŸ”§ å…¶ä»–</button>
  <button id="toggleHistoryBtn">ğŸ“š æ›¸ç±¤</button>

  
    <!-- ä¿®æ­£å¾Œçš„æ›¸ç±¤å´é‚Šæ¬„ï¼ˆID èˆ‡ JS åŒæ­¥ï¼‰ -->
    <div id="historySidebar">
      <h3>ğŸ“– æ›¸ç±¤ç´€éŒ„</h3>
      <div id="historyList"></div>
    </div>
  

<div id="featureMenu" class="feature-menu-hidden">
  <button id="featureCloseBtn" class="feature-close">Ã—</button>
  <div class="feature-title">â­ æˆ‘çš„æœ€æ„›</div>
  <div class="feature-menu-grid">
    <a href="https://df3011212.github.io/TradingPlanProduction/" target="_blank" class="feature-link-button">äº¤æ˜“è¨ˆç•«è¡¨</a>
    <a href="https://df3011212.github.io/RSI/" target="_blank" class="feature-link-button">OKX ä¸»æµå¹£ RSI æ’è¡Œæ¦œ</a>
    <a href="https://sosovalue.com/tc" target="_blank" class="feature-link-button">SoSoValue</a>
  </div>
</div>



    <script>
function openExam() {
  document.getElementById("examOverlay").style.display = "block";
}
function closeExam() {
  document.getElementById("examOverlay").style.display = "none";
}

async function fetchFundingRate(symbol) {
  const instId = symbol.replace('USDT.P', '-USDT-SWAP');
  try {
    const response = await fetch(`https://www.okx.com/api/v5/public/funding-rate?instId=${instId}`);
    const data = await response.json();
    if (data?.data?.length > 0) {
      const rate = parseFloat(data.data[0].fundingRate);
      const ratePercent = +(rate * 100).toFixed(6); // ä¿®æ­£æµ®é»æ•¸èª¤å·®
      const percentText = ratePercent.toFixed(4) + '%';

      document.getElementById("funding-rate").textContent = percentText;
      document.getElementById("funding-rate").style.color = rate > 0 ? "green" : rate < 0 ? "red" : "gray";

      const longDiv = document.getElementById("funding-rate-long");
      const shortDiv = document.getElementById("funding-rate-short");
      const isBTC = symbol.startsWith("BTC");

      let longClass = '', longStrategy = '', longColor = '';
      let shortClass = '', shortStrategy = '', shortColor = '';

      if (isBTC) {
        // BTC åšå¤š
        if (ratePercent >= -0.01 && ratePercent <= 0.03) {
          longClass = 'âœ… æ­£å¸¸ï¼ˆå»ºè­°å¯äº¤æ˜“ï¼‰';
          longColor = 'green';
        } else if ((ratePercent > 0.03 && ratePercent <= 0.2) || (ratePercent < -0.01 && ratePercent >= -0.03)) {
          longClass = 'âš ï¸ éæ­£å¸¸ï¼ˆé«˜æˆæœ¬å€ï¼‰';
          longColor = 'orange';
        } else if ((ratePercent > 0.2 && ratePercent <= 0.375) || (ratePercent < -0.2 && ratePercent >= -0.375)) {
          longClass = 'â— ç‰¹æ®Šï¼ˆé«˜é¢¨éšªï¼Œå‹¿è¿½é«˜ï¼‰';
          longColor = 'red';
        } else {
          longClass = 'ğŸŸ¡ ä¸åœ¨å®šç¾©ç¯„åœ';
          longColor = 'gray';
        }

        // BTC åšç©ºï¼ˆç¨ç«‹ï¼‰
        if (ratePercent >= -0.01 && ratePercent <= 0.03) {
          shortClass = 'âœ… æ­£å¸¸ï¼ˆå»ºè­°å¯äº¤æ˜“ï¼‰';
          shortColor = 'green';
        } else if ((ratePercent > 0.03 && ratePercent <= 0.2) || (ratePercent < -0.01 && ratePercent >= -0.03)) {
          shortClass = 'âš ï¸ éæ­£å¸¸ï¼ˆé«˜æˆæœ¬å€ï¼‰';
          shortColor = 'orange';
        } else if ((ratePercent > 0.2 && ratePercent <= 0.375) || (ratePercent < -0.2 && ratePercent >= -0.375)) {
          shortClass = 'â— ç‰¹æ®Šï¼ˆé«˜é¢¨éšªï¼Œå‹¿è¿½é«˜ï¼‰';
          shortColor = 'red';
        } else {
          shortClass = 'ğŸŸ¡ ä¸åœ¨å®šç¾©ç¯„åœ';
          shortColor = 'gray';
        }

      } else {
        // å…¶ä»–å¹£ç¨® åšå¤š
        if (ratePercent >= -0.02 && ratePercent <= 0.06) {
          longClass = 'âœ… æ­£å¸¸ï¼ˆå»ºè­°å¯äº¤æ˜“ï¼‰';
          longColor = 'green';
        } else if ((ratePercent > 0.06 && ratePercent <= 0.4) || (ratePercent < -0.02 && ratePercent >= -0.4)) {
          longClass = 'âš ï¸ éæ­£å¸¸ï¼ˆé«˜æˆæœ¬å€ï¼‰';
          longColor = 'orange';
        } else if ((ratePercent > 0.4 && ratePercent <= 0.75) || (ratePercent < -0.4 && ratePercent >= -0.75)) {
          longClass = 'â— ç‰¹æ®Šï¼ˆé«˜é¢¨éšªï¼Œå‹¿è¿½é«˜ï¼‰';
          longColor = 'red';
        } else {
          longClass = 'ğŸŸ¡ ä¸åœ¨å®šç¾©ç¯„åœ';
          longColor = 'gray';
        }

        // å…¶ä»–å¹£ç¨® åšç©º
        if (ratePercent >= -0.02 && ratePercent <= 0.06) {
          shortClass = 'âœ… æ­£å¸¸ï¼ˆå»ºè­°å¯äº¤æ˜“ï¼‰';
          shortColor = 'green';
        } else if ((ratePercent > 0.06 && ratePercent <= 0.4) || (ratePercent < -0.02 && ratePercent >= -0.4)) {
          shortClass = 'âš ï¸ éæ­£å¸¸ï¼ˆé«˜æˆæœ¬å€ï¼‰';
          shortColor = 'orange';
        } else if ((ratePercent > 0.4 && ratePercent <= 0.75) || (ratePercent < -0.4 && ratePercent >= -0.75)) {
          shortClass = 'â— ç‰¹æ®Šï¼ˆé«˜é¢¨éšªï¼Œå‹¿è¿½é«˜ï¼‰';
          shortColor = 'red';
        } else {
          shortClass = 'ğŸŸ¡ ä¸åœ¨å®šç¾©ç¯„åœ';
          shortColor = 'gray';
        }
      }

      // ç­–ç•¥èªªæ˜
      if (rate > 0) {
        longStrategy = 'âš ï¸ ä½ éœ€ä»˜è²»ï¼ˆç©ºæ–¹å¸‚å ´åå¼·ï¼‰';
        shortStrategy = 'âœ… å¯æ”¶è²»ï¼ˆå¸‚å ´åç©ºï¼‰';
      } else if (rate < 0) {
        longStrategy = 'âœ… å¯æ”¶è²»ï¼ˆå¸‚å ´åå¤šï¼‰';
        shortStrategy = 'âš ï¸ ä½ éœ€ä»˜è²»ï¼ˆå¤šæ–¹å¸‚å ´åå¼·ï¼‰';
      } else {
        longStrategy = 'ğŸŸ¡ ä¸­æ€§ï¼ˆé›™æ–¹ç„¡è³‡é‡‘è²»ï¼‰';
        shortStrategy = 'ğŸŸ¡ ä¸­æ€§ï¼ˆé›™æ–¹ç„¡è³‡é‡‘è²»ï¼‰';
      }

      longDiv.innerHTML = `ğŸ’¡ åšå¤šï¼š<span style="color:${longColor}">${longClass}</span>ï½œ<span style="color:${longColor}">${longStrategy}</span>`;
      shortDiv.innerHTML = `ğŸ’¡ åšç©ºï¼š<span style="color:${shortColor}">${shortClass}</span>ï½œ<span style="color:${shortColor}">${shortStrategy}</span>`;

    } else {
      document.getElementById("funding-rate").textContent = "ç„¡è³‡æ–™";
      document.getElementById("funding-rate-long").textContent = "";
      document.getElementById("funding-rate-short").textContent = "";
    }
  } catch (err) {
    console.error("è³‡é‡‘è²»ç‡å–å¾—éŒ¯èª¤ï¼š", err);
    document.getElementById("funding-rate").textContent = "éŒ¯èª¤";
    document.getElementById("funding-rate-long").textContent = "";
    document.getElementById("funding-rate-short").textContent = "";
  }
}






const symbolInput = document.getElementById("symbolInput");
if (symbolInput) {
  symbolInput.addEventListener("input", () => {
    const val = symbolInput.value.trim().toUpperCase();
    if (val.endsWith("USDT.P")) {
      fetchFundingRate(val);
    }
  });

  fetchFundingRate(symbolInput.value.trim().toUpperCase());

  setInterval(() => {
    const val = symbolInput.value.trim().toUpperCase();
    if (val.endsWith("USDT.P")) {
      fetchFundingRate(val);
    }
  }, 15000);
}



</script>

  <!-- âœ… ä¿®æ­£éçš„ JS è·¯å¾‘ -->

  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="js/features/ranking.js"></script>
  <script src="js/calc.js"></script>
  <script src="js/history.js"></script>
  <script src="js/features/manualAvg.js"></script>
  <script src="js/features/specifiedAvg.js"></script>
  <script src="js/features/quickRevenge.js"></script>
  <script src="js/features/advRevenge.js"></script>
  <script src="js/feature.js"></script>
  <script src="js/main.js"></script>
</body>
    <footer style="text-align:center; padding: 16px; font-size: 14px; color: gray;">
  æ´ªå£«å¼˜ ç‰ˆæ¬Šæ‰€æœ‰ Â©2025 å¤§ä»è€å¸«æŠ•è³‡ç†è²¡å­¸å ‚å°ˆå±¬å·¥å…·
</footer>

<!-- âœ… åŠ ä¸Šè¨ˆæ•¸å™¨ -->
<div style="text-align: center; margin-top: 8px;">
  <table border="0" cellspacing="0" cellpadding="0" style="margin: 0 auto;">
    <tr>
      <td>
        <a href="https://ctr.stylemap.co.jp/">
          <img src="https://www.f-counter.net/ani1/65/1749610404/" alt="å…è²»ã‚¢ã‚¯ã‚»ã‚¹ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼" style="border:0; vertical-align:bottom">
        </a>
      </td>
      <td>
        <a href="https://ctr.stylemap.co.jp/">
          <img src="https://www.f-counter.net/ani2/65/1749610404/" alt="å…è²»ã‚¢ã‚¯ã‚»ã‚¹ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼" style="border:0; vertical-align:bottom">
        </a>
      </td>
    </tr>
  </table>
</div>
</html>
